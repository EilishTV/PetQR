<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mascota</title>

  <!-- Font Awesome -->
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
  />

  <style>
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: #f4f4f4;
      color: #111;
    }

    .card {
      max-width: 420px;
      margin: 0 auto;
      background: #fff;
      border-radius: 0 0 18px 18px;
      overflow: hidden;
    }

    .image-container {
      position: relative;
      aspect-ratio: 4 / 5;
    }

    .image-container img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .image-container::after {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(to top, rgba(0,0,0,.85), rgba(0,0,0,0) 55%);
    }

    .status-badge {
      position: absolute;
      bottom: 58px;
      left: 16px;
      padding: 6px 12px;
      border-radius: 50px;
      font-size: 13px;
      font-weight: 700;
      display: none;
      z-index: 3;
    }

    .status-badge.lost {
      display: inline-block;
      background: rgba(253,34,78,.9);
      border: 2px solid #d6002f;
      color: #fff;
      animation: pulse 1.5s infinite;
    }

    .status-badge.found {
      display: inline-block;
      background: rgba(60,200,120,.9);
      border: 2px solid #0f7a3a;
      color: #fff;
    }

    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(214,0,47,.6); }
      70% { box-shadow: 0 0 0 8px rgba(214,0,47,0); }
      100% { box-shadow: 0 0 0 0 rgba(214,0,47,0); }
    }

    .pet-header {
      position: absolute;
      bottom: 16px;
      left: 16px;
      right: 16px;
      display: flex;
      gap: 10px;
      color: #fff;
      z-index: 2;
      align-items: center;
    }

    .pet-name { font-size: 26px; font-weight: 700; }
    .pet-age { font-size: 18px; opacity: .9; }

    .info, .extra-info { padding: 16px; font-size: 15px; }
    .info { border-bottom: 1px solid #e5e5e5; }

    .extra-info h3 { margin: 14px 0 8px; font-size: 15px; }

    .info-row {
      display: flex;
      gap: 10px;
      align-items: center;
      margin-bottom: 6px;
    }

    .info-row i {
      width: 18px;
      color: #555;
    }

    .info-row a {
      color: #007aff;
      text-decoration: none;
      font-weight: 500;
    }

    /* BOTÓN EDITAR */
    .edit-btn {
      position: fixed;
      bottom: 20px;
      left: 20px;
      width: 52px;
      height: 52px;
      background: #fff;
      border-radius: 50%;
      display: none;
      justify-content: center;
      align-items: center;
      box-shadow: 0 6px 20px rgba(0,0,0,.25);
      cursor: pointer;
      z-index: 1000;
    }

    .edit-btn i { font-size: 20px; }

    .edit-actions {
      position: fixed;
      bottom: 20px;
      right: 20px;
      display: none;
      gap: 10px;
      z-index: 1000;
    }

    .edit-actions button {
      padding: 12px;
      border-radius: 50%;
      border: none;
      cursor: pointer;
      font-size: 18px;
      box-shadow: 0 6px 20px rgba(0,0,0,.25);
    }

    .save { background: #22c55e; }
    .cancel { background: #ef4444; color: #fff; }

    /* INPUTS / TEXTAREA EDICIÓN */
    input[data-field], textarea[data-field] {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      font-size: inherit;
      color: inherit;
      background: rgba(255,255,255,0.2);
      border: 1px solid #ccc;
      border-radius: 6px;
      padding: 2px 4px;
      width: 100%;
      box-sizing: border-box;
      color: #111;
    }

    /* Inputs / textarea para edición */
input[data-field], textarea[data-field] {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
  font-size: inherit;
  font-weight: 700; /* <-- fuerza bold */
  color: inherit;
  background: rgba(255,255,255,0.2); /* semi-transparente sobre imagen */
  border: 1px solid #ccc;
  border-radius: 6px;
  padding: 2px 4px;
  width: 100%;
  box-sizing: border-box;
}

  </style>
</head>

<body>

<div class="card">

  <div class="image-container">
    <img id="petImage">
    <div id="statusBadge" class="status-badge"></div>

    <div class="pet-header">
      <div class="pet-name" data-field="name"></div>
      <div class="pet-age" id="petAge"></div>
    </div>
  </div>

  <div class="info">
    <strong>Información</strong><br>
    Si encontraste esta mascota, por favor comunicate con su dueño.
  </div>

  <div class="extra-info">

    <h3>Datos del dueño</h3>
    <div class="info-row"><i class="fa-user fa-solid"></i><span data-field="owner.name"></span></div>
    <div class="info-row"><i class="fa-location-dot fa-solid"></i><span data-field="owner.location"></span></div>

    <h3>Información del animal</h3>
    <div class="info-row"><i class="fa-weight-scale fa-solid"></i><span data-field="petInfo.weight"></span></div>
    <div class="info-row"><i class="fa-ruler fa-solid"></i><span data-field="petInfo.size"></span></div>
    <div class="info-row"><i class="fa-palette fa-solid"></i><span data-field="petInfo.color"></span></div>

    <h3>Observaciones</h3>
    <div class="info-row"><i class="fa-note-sticky fa-solid"></i><span data-field="notes"></span></div>

  </div>
</div>

<!-- Botón editar -->
<div id="editBtn" class="edit-btn"><i class="fa-solid fa-pencil"></i></div>

<div id="editActions" class="edit-actions">
  <button class="save"><i class="fa-solid fa-check"></i></button>
  <button class="cancel"><i class="fa-solid fa-xmark"></i></button>
</div>

<script>
const isLoggedIn = true;

let petData = {
  name: "Luna",
  birthDate: "2023-09-21",
  image: "https://upload.wikimedia.org/wikipedia/commons/1/18/Rostkatze.JPG",
  status: "lost",
  owner: { name: "María López", location: "Palermo, CABA" },
  petInfo: { weight: "6 kg", size: "Mediano", color: "Atigrado" },
  notes: "Es mansa y responde a su nombre."
};

let backup = {};

function getAgeText(birthDate) {
  const b = new Date(birthDate);
  const t = new Date();
  let m = (t.getFullYear() - b.getFullYear())*12 + (t.getMonth() - b.getMonth());
  if(t.getDate()<b.getDate()) m--;
  return m<24 ? `· ${m} meses` : `· ${Math.floor(m/12)} años`;
}

// Acceso y actualización de objetos anidados
function get(path) {
  return path.split('.').reduce((o,k)=>o[k], petData);
}
function set(path,value){
  const keys = path.split('.');
  keys.slice(0,-1).reduce((o,k)=>o[k], petData)[keys.at(-1)] = value;
}

// Renderiza todo en pantalla
function render(){
  document.querySelectorAll("[data-field]").forEach(el=>{
    el.textContent = get(el.dataset.field);
  });
  petImage.src = petData.image;

  // Edad
  petAge.textContent = getAgeText(petData.birthDate);

  // Estado
  const badge = document.getElementById("statusBadge");
  if(petData.status==="lost"){badge.textContent="¡Perdido!"; badge.className="status-badge lost";}
  else if(petData.status==="found"){badge.textContent="¡Encontrado!"; badge.className="status-badge found";}
  else{badge.textContent=""; badge.className="status-badge";}
}

// Entrar en modo edición
function enterEdit(){
  backup = JSON.parse(JSON.stringify(petData));

  document.querySelectorAll("[data-field]").forEach(el=>{
    let input;
    if(el.dataset.field === "notes") input = document.createElement("textarea");
    else input = document.createElement("input");

    input.value = get(el.dataset.field);
    input.dataset.field = el.dataset.field;

    // Copiar estilos del elemento original
    const style = window.getComputedStyle(el);
    input.style.fontFamily = style.fontFamily;
    input.style.fontSize = style.fontSize;
    input.style.fontWeight = style.fontWeight;
    input.style.color = style.color;
    input.style.background = "rgba(255,255,255,0.2)";
    input.style.border = "1px solid #ccc";
    input.style.borderRadius = "6px";
    input.style.padding = "2px 4px";
    input.style.width = "100%";
    input.style.boxSizing = "border-box";

    el.replaceWith(input);
  });

  // Crear input para la imagen
  const imgInput = document.createElement("input");
  imgInput.type = "text";
  imgInput.value = petData.image;
  imgInput.dataset.field = "image";
  imgInput.placeholder = "URL de la imagen";
  imgInput.style.width = "100%";
  imgInput.style.marginBottom = "8px";
  imgInput.style.padding = "4px";
  imgInput.style.boxSizing = "border-box";
  document.querySelector(".image-container").prepend(imgInput);

  // Crear selector para estado
  const select = document.createElement("select");
  select.dataset.field = "status";
  ["", "lost", "found"].forEach(s=>{
    const opt = document.createElement("option");
    opt.value = s;
    opt.textContent = s === "lost" ? "Perdido" : s === "found" ? "Encontrado" : "Ninguno";
    if(petData.status===s) opt.selected = true;
    select.appendChild(opt);
  });
  select.style.marginBottom = "8px";
  select.style.padding = "4px";
  select.style.width = "100%";
  select.style.boxSizing = "border-box";
  document.querySelector(".image-container").prepend(select);

  editActions.style.display="flex";
  editBtn.style.display="none";
}

// Salir del modo edición
function exitEdit(save){
  if(!save) petData = backup;

  // Guardar imagen y estado
  const imgInput = document.querySelector(".image-container input[type=text]");
  const select = document.querySelector(".image-container select");
  if(save){
    if(imgInput) petData.image = imgInput.value;
    if(select) petData.status = select.value;
  }

  if(imgInput) imgInput.remove();
  if(select) select.remove();

  // Guardar campos
  document.querySelectorAll("input[data-field], textarea[data-field]").forEach(el=>{
    if(save) set(el.dataset.field, el.value);

    const span = document.createElement("span");
    span.dataset.field = el.dataset.field;

    // Restaurar clases importantes
    if(el.dataset.field === "name") span.className = "pet-name";
    else if(el.dataset.field === "notes") span.style.whiteSpace = "pre-wrap";

    el.replaceWith(span);
  });

  render();
  editActions.style.display="none";
  editBtn.style.display="flex";
}

// Eventos botones
editBtn.onclick = enterEdit;
editActions.children[0].onclick = ()=>exitEdit(true); // Guardar
editActions.children[1].onclick = ()=>exitEdit(false); // Cancelar

// Mostrar lápiz si está logueado
if(isLoggedIn) editBtn.style.display="flex";

// Render inicial
render();
</script>



</body>
</html>
